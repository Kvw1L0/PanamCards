<!DOCTYPE html>
<html lang="es"><head><meta charset="UTF-8"/><title>Selfie</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>body{background:black;color:white;font-family:sans-serif;display:flex;flex-direction:column;align-items:center;padding-top:2rem;margin:0;}video{width:300px;height:300px;border-radius:8px;border:2px solid white;margin-bottom:1rem;}button{padding:1rem;font-size:1.2rem;margin-top:1rem;}</style>
</head><body onload="activarCamara()"><h2>Hola <span id="nombreUsuario"></span>, tómate una selfie</h2>
<video id="camera" autoplay playsinline muted></video><canvas id="snapshot" width="224" height="224" style="display:none;"></canvas>
<button onclick="tomarFoto()">Tomar Selfie</button>
<script>document.getElementById('nombreUsuario').innerText=localStorage.getItem('nombre')||'';async function activarCamara(){try{const s=await navigator.mediaDevices.getUserMedia({video:true});document.getElementById('camera').srcObject=s;}catch(e){alert('Error cámara:'+e.message);}}function tomarFoto(){const v=document.getElementById('camera'),c=document.getElementById('snapshot'),ctx=c.getContext('2d');ctx.drawImage(v,0,0,c.width,c.height);localStorage.setItem('foto',c.toDataURL());window.location.href='stats.html';}</script>
</body></html>