<!DOCTYPE html>
<html lang="es">
<head><meta charset="UTF-8"/><title>Tarjeta Final</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{background:black;display:flex;flex-direction:column;align-items:center;justify-content:center;color:white;font-family:'Montserrat',sans-serif;height:100vh;}
canvas{background:none;}
button{margin:0.5rem;padding:0.5rem 1rem;border:none;border-radius:5px;font-size:1rem;cursor:pointer;}
#shareBtn{background:#e1306c;color:white;}#downloadBtn{background:gold;color:black;}
</style></head>
<body>
<canvas id="cardcanvas" width="492" height="764"></canvas>
<div><button id="shareBtn" onclick="shareStory()">Compartir en Instagram</button>
<button id="downloadBtn" onclick="downloadCard()">Descargar</button></div>
<script>
document.fonts.ready.then(drawCard);
function drawCard(){
  const cv=document.getElementById('cardcanvas'),ctx=cv.getContext('2d');
  const bg=new Image();bg.src='panamcard.png';bg.onload=()=>{
    ctx.drawImage(bg,0,0,cv.width,cv.height);
    const avatar=new Image();avatar.src=localStorage.getItem('foto');
    avatar.onload=()=>{
      ctx.drawImage(avatar,123,91,246,214);
      ctx.fillStyle='white';ctx.font='700 32px Montserrat';ctx.textAlign='right';
      ctx.fillText('FRZ',172,443);ctx.fillText('VEL',172,520);ctx.fillText('RES',172,596);
      ctx.textAlign='left';ctx.fillText(localStorage.getItem('d1'),320,443);
      ctx.fillText(localStorage.getItem('d2'),320,520);ctx.fillText(localStorage.getItem('d3'),320,596);
    };
  };
}
function shareStory(){
  const cv=document.getElementById('cardcanvas');
  cv.toBlob(blob=>{
    const reader=new FileReader();reader.onload=()=>{
      location.href='instagram://story-camera?background_image='+encodeURIComponent(reader.result);
    };reader.readAsDataURL(blob);
  });
}
function downloadCard(){
  const cv=document.getElementById('cardcanvas');
  const a=document.createElement('a');a.download='tarjeta.png';a.href=cv.toDataURL();a.click();
}
</script></body></html>